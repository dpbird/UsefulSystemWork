\sectionquestion{RNNs and CNNs}

\begin{parts}
\part[2] In which of the following ways does a convolutional layer help detect spatial patterns in an image?
{\checkboxchar{$\Box$} \checkedchar{$\blacksquare$}
\begin{checkboxes}
    \choice By learning features at various levels of abstraction, detecting simpler patterns at lower layers and complex spatial patterns at higher layers.
    \choice By applying convolution on an arbitrarily selected subset of input channels through back-propagation.
    \choice By iteratively adjusting the weights of the filters through back-propagation.
    \choice By sharing parameters while learning features across an image thereby enabling translation invariance.
    \choice None of the above.
\end{checkboxes}}
    \begin{soln}
    A, C, D only. convolutional layers apply the same filter to all parts of the image (spatially invariant/equivariant) and  different layers of the network detect features at various levels of abstraction. They adjust the optimal filter weights through back-propagation and apply pooling to aggregate pixel information, helping detect patterns in an image.
    \end{soln}
    \begin{qauthor}
    Siva (edited by Matt), Explain how the shared parameters of a convolutional layer could learn to detect spatial patterns in an image

    Update: Updated wording to more precise after testing comments.
    \end{qauthor}

\part Consider a \textit{linear} recurrent neural network for which $\xv^{(t)}, \hv^{(t)}, \hat{\yv}^{(t)} \in \Rb^2$ and where $\hv^{(t)} = \Wv \hv^{(t-1)} + \Vv \xv^{(t)}$ and $\hat{\yv}^{(t)} = \Uv \hv^{(t)}$. 

    \begin{minipage}{0.6\linewidth}
    \begin{center}
    \input{elman.tex}
    \end{center}
    \end{minipage}
    \begin{minipage}{0.4\linewidth}
    \begin{align*}
        \Wv &= \begin{bmatrix} 2 & 0 \\ 0 & 2 \end{bmatrix} \\ \\
        \Vv &= \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix} \\ \\
        \Uv &= \begin{bmatrix} 3 & 0 \\ 0 & 3 \end{bmatrix} 
    \end{align*}
    \end{minipage}

    \begin{subparts}
    \subpart[2] \textbf{Numerical answer:} What is the value of $\hv^{(2)}$?
        \begin{tcolorbox}[fit,height=2cm, width=7cm, blank, borderline={1pt}{-2pt}]
        %solution
        \end{tcolorbox}
        \begin{soln}
            \begin{align*}
                %\hv^{(1)} &= [2,1]^T \\
                \hv^{(2)} &= [5,2]^T \\
            \end{align*}
        \end{soln}
        \begin{qauthor} Matt \end{qauthor}

    % REMOVED FOR TIME
    % \subpart[1] \textbf{Numerical answer:} What is the value of $\yv^{(6)}$?
    %     \begin{tcolorbox}[fit,height=2cm, width=7cm, blank, borderline={1pt}{-2pt}]
    %     %solution
    %     \end{tcolorbox}
    %     \begin{soln}
    %         \begin{align*}
    %             \yv^{(6)} = [-6,15]^T
    %         \end{align*}
            
    %     \end{soln}
    %     \begin{qauthor} Matt \end{qauthor}

    \clearpage
    
    \subpart[2] \textbf{Short answer:} Paloma the Possum observes that all the parameters for the RNN are positive, but somehow $\hv^{(6)}$ contains a negative value. Is there an error in the computation somewhere? \textbf{Briefly justify your answer.}
        \fillwithlines{8em}
        \begin{soln}
        No, there is no error. One or more of the input vectors $\xv^{(3)},\ldots, \xv^{(6)}$ must contain negative values.
        \end{soln}
        \begin{qauthor} Matt \end{qauthor}
        
    \end{subparts}

\part You wish to apply a $2 \times 2$ convolution with a vertical and horizontal stride of $3$ to a $5 \times 9$ grayscale image. There is no padding.

    \begin{minipage}{0.6\linewidth}
    \centering
    Image: 
    
    \begin{tikzpicture}[x=1cm, y=1cm]
    % Draw the grid lines
    \draw[black] (0,0) grid (9,5);
    \end{tikzpicture}
    
    \end{minipage}
    \begin{minipage}{0.4\linewidth}
    \centering
    Convolution:
    
    \begin{tikzpicture}[x=1cm, y=1cm]
    % Draw the grid lines
    \draw[black] (0,0) grid (2,2);
    \end{tikzpicture}
    
    \end{minipage}

    
    \begin{subparts}
    
    \subpart[2] \textbf{Drawing:} On the image above, draw a square indicating each location at which the convolution matrix is applied to the underlying pixels of the image? 
    
        \begin{soln}
        \begin{tikzpicture}[x=1cm, y=1cm]
        % Draw the grid lines
        \draw[black] (0,0) grid (9,5);
        % Draw the squares
        \foreach \x in {0,3,6} {
          \foreach \y in {0,3} {
            \fill (\x,\y) rectangle ++(2,2);
          }
        }
        \end{tikzpicture}
        \end{soln}
        \begin{qauthor} Matt \end{qauthor}

    \subpart[1] \textbf{Numerical answer:} What are the dimensions (\# rows $\times$ \# columns) of the convolved image, i.e. the output?
        \begin{tcolorbox}[fit,height=2cm, width=7cm, blank, borderline={1pt}{-2pt}]
        %solution
        \end{tcolorbox}
        \begin{soln}
            $(2, 3)$
        \end{soln}
        \begin{qauthor} Matt \end{qauthor}
        

    \end{subparts}

\end{parts}